import Bio.PDB
import csv
import gzip
import os
import warnings
import re
import threading
import logging

warnings.filterwarnings("ignore")

seqSet = set()

pdbstr = '2ALG,2B0S,2AP2,2B1H,2B1A,2ARW,2B4C,2B4I,2B4H,2B5S,2AXG,2A9N,2A9M,2ACM,2ADF,2AEQ,2AEP,2AJ3,2AK4,2AJF,1ZEA,1ZHB,1ZHL,1ZHK,1ZSD,1ZTX,1ZVS,2A6D,2A6K,2A6J,2A6I,2GYS,2HJK,2HJL,2HKH,2HKF,2I27,2I26,2I25,2I24,2I69,1XDD,1XDG,1XGY,1XKG,1WZ1,1WZ4,25C8,1TET,1TJI,1TJH,1TJG,1TOS,1TOR,1TQC,1TQB,1TPX,1TT9,1U8J,1U8I,1U8H,1U93,1U8Q,1U92,1U8P,1U91,1U8O,1U8N,1U8M,1U8L,1QR1,1QVO,1QVN,1QVY,1RHH,1RJZ,1RJY,1RK1,1RK0,1RJL,2I9L,2IAN,2IAM,2IAL,2ICI,2IFS,2IHO,2IJ0,2IQ9,2IPU,2IPT,2IQA,2J4W,1U95,1TZI,1TZH,1TZG,1UA6,1UAC,1UGN,1UMX,1W81,1W8K,1VYG,1VYF,1WBZ,1WBY,1WBX,1WEJ,1WM0,1WRF,1Q94,1Q9O,1Q9L,1Q9K,1Q9W,1Q9B,1PXZ,1QBM,1QBL,1QD0,1QFU,1QGT,1QLF,3X13,3SQO,3SRP,3I6K,3I6L,3I6G,5A1Z,5A2I,5A2K,5A2J,5A2L,5A3I,5A8H,5A7X,5AAM,5AAW,5ACO,5AJC,5AJB,4ZTO,4ZTP,4ZUW,4ZUS,4ZUT,4ZUU,4ZUV,5BK0,5BK3,5BK5,5ANY,5B2D,5B2C,5B5R,5AWN,4M1D,4LVH,4MDI,4MDJ,4MCZ,4MD4,4MD5,4MCY,4MD0,4MHH,4MHI,4MHJ,4NBX,4NBY,4NBZ,4NC1,4NC2,4MJI,4MNG,4MNH,4MQ7,4N0Y,4MUC,4MWF,4DGV,4DGY,4DNS,4DQO,4DTG,4F33,4F3F,4EDW,4EDX,4PY7,4PY8,4PZ5,4QEX,4QF1,4QNP,4QOK,4RGM,4RGN,4RGO,4QRP,4QRQ,4QRS,4R3S,4QRT,4R4N,4QT5,4R4F,4R4H,4R4B,4QRU,4R7N,4R7D,4QXT,4QY8,4QXG,4QYO,4RDJ,4RDK,4RDL,4RFE,4RFN,4RFO,3ZZV,4AE7,4AEH,4AEI,4AE8,4B5C,4B50,4BH7,4BH8,4BKL,4N9G,4MZV,4NC0,4NEH,4NDM,4NEN,4NGH,4NHC,4NH2,4NIK,4NKI,4NKM,4NKO,4NKD,4NM4,4NM8,4NP4,4NQV,4NQX,4NT6,4NRX,4NRY,4NRZ,4O5J,4NUG,4NUJ,4ODH,4OD1,4OCR,4OD3,4OCS,4OCW,3T4Y,3T65,3T77,3SY0,3TCL,3TF7,3TFK,3TID,3TIE,3TJH,3TNM,3TO4,3U1S,3TPU,3U2S,3U36,3U4B,3U4E,3U46,3TV3,3TWI,3TWC,3TYJ,3TYG,4KI5,4KMB,4KPH,4LLV,4L3E,4KTH,4KW1,4L8I,4KWM,4L8B,4L8C,4L8D,4UP4,4UQ2,4UQ3,4UT1,4UTC,4UTA,4UTB,4UT6,4UT7,4UT9,4UU9,4UV7,4UX8,4X42,4X80,4X7C,4X7D,4X7E,4X7F,4WV8,4X8J,4XVJ,4XAW,4XAK,4XBP,4XC1,4XC3,4XBG,4XBE,4XCY,4XCN,4XCC,4XCE,4XCF,4XIB,4XI5,4XI6,4XI7,4XHR,4XHJ,4XIZ,4GAG,4GAJ,4GAY,4GG6,4GG8,4GLR,4GKZ,4GMS,4GMT,4GSS,4GTU,4H8W,4GXU,4GXV,4GXX,4HEM,4HEP,4HF5,4HG4,4HFU,4HFW,4HJ0,4GOS,4H0G,4H0H,4H0I,4H26,4H25,4H1L,4JB9,4JAM,4JAN,4JDM,4JDN,4JDO,4JJ5,4JM2,4JLR,4JM4,4JO1,4JO2,4JO3,4JO4,4K23,4K24,4K2U,4JQV,4JQX,4K5U,4K79,4JVP,4K7F,4JY4,4JY5,4JY6,3RHU,3RI0,3RIJ,3RKD,3RKC,3RJO,3RL1,3RL2,3RPT,3SMH,3RRR,3S44,3RRT,3RU8,3RVT,3RVU,3RVV,3RWH,3RWI,3RWJ,3RWC,3RWD,3RWE,3RWF,3RWG,3RVW,3S88,3RVX,3SE8,3SE9,3SDY,3WUW,3ZCF,3ZOO,3ZTJ,3ZUE,3ZTN,3ZWE,3ZW0,3ZW2,4AGI,3MA7,3MGO,3MGT,3MK9,3MLZ,3MLR,3MLS,3MLT,3MLU,3MLV,3MLW,3MLX,3MLY,3LV3,3LZF,3LZG,3MRR,3MRH,3MRL,3MRO,3MRC,3MRD,3MRE,3MRG,3MV7,3MV8,3MV9,4PGJ,4PG2,4PLJ,4PLK,4PP1,4PP2,4Q0X,4POZ,4PR5,4PRN,4PRP,4PRH,4PRI,4OV5,4OUO,4P9M,4P9H,4OZG,4OZH,4OZI,4OZF,4PB9,4PB0,4PRA,4PRB,4PRD,4PRE,4Q5P,4PV8,4PV9,3HZV,3HZY,3HZM,3HZK,3IDG,3IDI,3IDJ,3IDM,3IDX,3IDY,3IDN,3IFL,3IFN,3IFO,3IF1,3IET,3IFP,3J05,3J3Z,3J5M,3J6S,3J6T,3J6U,3J7E,3J7G,3IXT,3IYW,3JBA,4EJ1,4EIG,4EIZ,4FFY,4FFZ,4FHB,4FNL,4FNK,4FP8,4FQ1,4FQ2,2X7R,2XFX,2XIW,2XQB,4HLZ,4I18,4HS8,4HS3,4I3R,4I3S,4HS6,4HUU,4HUV,4HUW,4HV8,4HUX,4HWB,4HXA,4HXB,4HWE,4HZL,4Z68,4Z7I,4YVS,4Z7U,4Z7V,4YVW,4Z7W,4Z9K,4ZD3,4ZFO,4ZJS,4ZMJ,4ZYK,4ZYP,5N10,5MP6,5N0A,5N09,5N2C,5N48,5N47,5N6B,5N7W,5MZM,5NIG,5NI9,5O03,5O02,5O05,5O04,5NMV,5O14,5NQ1,5NQ0,5NQ3,5O1R,5NQ2,5NPH,5NPJ,5NPI,5LBS,5LBV,5LCV,5LKE,5LKF,5LNK,5LQB,5M63,5D2L,5D2N,5CZV,5CZX,5DD0,5DD1,5DD3,5DD6,5DD5,4U1H,4U1I,4U1J,4U1K,4U1L,4U1M,4U1N,4U1G,4TOY,4U0Q,4U0R,4U2A,4U1S,4RNR,4S1D,4RQQ,4S2S,4RX4,4RWY,5BRZ,5BS0,5BSY,5BSX,5BVJ,5C7K,5BVP,5C97,5BZW,5CCK,5CEX,5CEZ,5CEY,5CIL,5CIN,5CIP,5CJX,4XUW,4XXC,4YC2,4YBL,4YE4,4YDI,4YDJ,4YDK,4YDL,4YFS,4YFL,4IHO,4IOS,4ISV,4J6R,5I2I,5H94,5GZR,5GZO,5GZN,3UES,3UET,3UJT,3UJI,3UJJ,3V0R,4D69,4D8P,4D9L,4DAG,2V2W,2V2X,2UUD,2UYL,2VE6,2VFY,2VFK,2VFL,2VL5,2VLR,2VLJ,2VLK,3PP3,3PP4,3Q1S,3Q6F,3Q6G,3PWU,3PWV,3PWJ,3UYP,3UZQ,3UZV,3UZE,3VE0,3W0W,3W39,3OKO,3OP8,3OX8,3P9W,3OXR,3OXS,4C2I,4BUH,4CAU,4CFI,3VTT,3VXM,3VXN,3VXO,3VXP,3VXQ,3VXR,3VXS,3VXT,3VWX,3VXU,3WLB,3WL9,3X14,3X11,3X12,3LF6,3LEV,3LEX,3LF9,3LEY,3LES,3LG7,3LH2,3LHP,3LIZ,3LKN,3LKO,3LKP,3LKQ,3LM1,3LKR,3LKS,3LN4,3LMJ,3LLY,3LLZ,3LN5,3M1N,3M1C,3M18,3M19,3LQA,3M3Q,3M3O,3M3C,3M3E,3LRG,3LRH,5XWD,5Y9F,5Y9E,5Y9J,5Y9K,5Y9C,5YHQ,5YLX,5YNY,5YNX,5YWP,5YWO,5YWF,5YY5,5ZBO,5ZGA,5ZG5,5ZG4,5ZFX,5ZIA,5ZJU,5KG9,5JQ6,5KKM,5KN5,5KS9,5KSB,5KSA,5KW9,5KVE,5KVD,5KVG,5KVF,5KWB,5KZP,6DID,2RCS,35C8,2SAK,2PW2,2PW1,2QHR,2QJB,2QJA,2QJ9,2R0W,2R0Z,2R2H,2R2E,2R2B,2R1X,2R1W,2R23,2R1Y,2QRI,2R3X,2QRT,2QRS,2R5K,2R5J,2R5I,2R5H,2R61,2R56,6WFX,6WFW,6WFZ,6WFY,6WG1,6WG0,6WG2,2OQJ,2P1Y,2P24,2OR9,2ORB,2OSL,2P8P,2P8M,2P8L,2OX9,2OX8,2PR4,2PSM,3K7B,3K9A,3KLA,3KMB,3L0H,3L3J,3L3K,3L3D,3L3G,3L3H,3L3I,3LC9,3LEF,3BKJ,3BKC,3C08,3C09,3BPC,3BQU,3BUY,3BWA,3BW9,3C9Z,3CA0,3CAH,3CA1,3CA3,3CA4,3CA5,3CA6,3CCH,3CC5,3CFI,3CFB,3CFC,3CFD,3CFE,3CH1,3D0V,3D0L,3D25,3CPL,3CSP,3CVH,3CVI,3CXD,3EYS,3EYU,3FCT,3FMG,3FO0,3FO1,3FO2,3G5Y,3G5Z,3G5V,3G5X,3FTG,3GBM,3GB8,3GAX,3GBN,3GIV,3GIZ,3FQW,3FQX,3FQN,3FQR,3FQT,3FQU,3DRQ,3DRT,3DRO,3DSF,3DUU,3DV6,3DUR,3DUS,3DV4,3E6F,3E6H,3DXA,3DX7,3DX8,3DX9,3DX6,3E8U,3EBK,3EBW,3EGS,3EO9,3EO0,3EO1,3EOA,3EOB,2VVK,2VWF,2VXQ,2VXS,2VXT,2VXU,2VXV,2VLL,2VLM,2W0Z,2W10,2VQ1,2WQ4,2X1O,2X1P,2X1Q,2X2T,2WQL,2X2S,2X4P,2X4Q,2X4T,2X7K,3AFK,3BKY,3BKM,3ARB,3B2U,3B2V,3ARD,3ARE,3ARF,3ARG,3AYC,3AYD,3AYE,3AYA,3B9K,3BAE,3BE1,3BDY,3BK3,3GNM,3GO1,3GRW,3H3P,3GSW,3GSX,3GSO,3GSQ,3GSR,3GSU,3GSV,3GSN,3GTU,3HG1,3HI1,3HMW,3I02,3HMX,3HPJ,3MXV,3MXW,3N9G,3MYJ,3MZW,3NGB,3O0E,3O41,3O45,3O76,3O6K,3O6L,3O6M,3NZ8,3OAY,3OAZ,3OB0,3OB4,3OJD,3OKK,3OKL,3OKM,3OKN,3OKD,3OKE,2YQ2,2YQ3,2YPV,2YPK,2YPL,2Z8L,2YWY,2YWZ,2ZCK,2ZCL,2ZCH,2ZOK,2ZOL,2ZPK,2ZSV,2ZSW,3R06,3R08,3QQ3,3QQ4,3PWL,3PWN,3PWP,3QWO,3QXT,3QXU,3QXV,3QXW,3RFN,3RGQ,3RGO,5IR1,5J3V,5J3D,5ISZ,5ITB,5J5E,5ITF,5IV2,5IVZ,5IVO,5IVN,5JHL,5JHM,5JHD,5JW3,5JW5,5JW4,5JWE,5JWD,5K9K,5K9O,5K9Q,5K9J,5JZI,5KAN,5KAQ,5KD7,5KD4,5KEL,5KEN,5KEM,5DMI,5DMK,5DMJ,5E00,5E1H,5E2U,5E2T,5E2W,5E2V,5DRZ,5E8E,5E8P,5DWU,5E8O,5E8N,5EA0,5EO0,5EO1,5EOR,5EOQ,5EOC,6B3K,6AT9,6B5V,6AVN,6B9J,6AXL,6AXK,6AWL,6AZM,6AZX,6BAN,6BB4,6BA5,6BF4,6BFS,6BFQ,6BKB,6BKD,6BKC,6BLX,6BLQ,6BLR,6BLI,6BLH,6BLA,6BSB,6BSC,6BSP,6BT3,6C5V,6C5I,6C5H,6C5K,6C5J,5FCU,5FF6,5FGC,5FGB,5FXC,5FXU,5FYN,5GGR,5GGQ,5GGT,5GGS,5GGV,5GGU,5GHW,5GJS,5GJT,5GNB,5GR7,5H2B,5GRD,5GRG,5GSR,5GSV,5GSX,5GSB,5GSD,5NQW,5NPZ,5NUZ,5NVP,5NWW,5NWV,5NWU,5NYX,5OMN,5OMM,5OMZ,5OQH,5OQG,5OQI,5OQF,6IEA,6IGE,6IGD,6IGF,6IGC,6II4,6II9,6II8,6IKM,6J11,6J1W,6J2A,6IRL,6J5D,6J5C,6J5F,6J5G,6IWG,6IWH,6JBT,6JHQ,6JHS,6JHR,6JHT,6JJP,6JLI,6D0X,6D11,6D2P,6CRQ,6BXQ,6BXP,6CA7,6CA6,6CA9,6CBP,6CBE,6CBJ,6CCB,6CBU,6CUJ,6CYF,6DCQ,6DDR,6DDM,6DCV,6DCW,6DDV,6DFQ,6DFS,6DFW,6DFV,6DFI,6DFJ,6DEW,6DFX,5OTJ,5OWP,5OXS,5OXR,6F0H,6F0G,6F0F,6EQA,6EQB,6EWA,6EWC,6EWO,6FAB,6FAX,6FG2,6FG1,6GLX,6GLW,6H06,6H0E,6H2Y,6H41,6H5N,6H6Y,6H6Z,6H70,6H72,6H71,6GV4,6GG0,6GH1,6GH4,6GGM,6GHN,6GK7,6GK8,6GKS,6GKU,6GKT,6GKQ,6GL1,5I5D,5I5F,5I5H,5I8C,5HVF,5HVH,5HVG,5I8E,5I8H,5IDL,5IF0,5IFJ,5IFA,5IES,5IG7,5IHL,5IIE,5IHZ,5IK3,5IJK,5IML,5IMK,5IMM,5IMO,5IOP,5ZUD,5ZUF,5ZV3,5ZXV,6A4K,6A6H,4U36,4TSE,4U3X,4U6H,4U6X,4U6Y,4TWT,4UIF,4UIH,5WTT,5X8M,5X8L,5X7Y,5WXC,5WXD,5WWU,5X8Y,5XHV,5XMH,5XND,5Y0A,5Y0W,5Y0Y,5Y10,5Y11,5XRQ,5XRT,5XS5,5XRS,5XS4,5XS7,5X08,5WOV,5WOW,5WSH,5VXR,5VZ5,5VYB,5WKF,5WKH,5WK4,5WJL,5WJN,5WLG,5WLI,5WMN,5WMP,5WMO,5WMR,5WMQ,5UJT,5V2A,5V1Y,5V1Z,5UR8,5USL,5V4N,5V4M,5USH,5V5M,5V5L,5V6M,5V6L,5V7R,5V7U,5V7J,5UVD,5V8L,5V8M,5UY3,5UEM,5UEL,5VAG,5VCJ,5VCO,5VCN,5VK2,5W0K,5VPH,5VPG,5W1G,5VPL,5W1K,5W1N,5W1M,5W1W,5W1V,5W4L,5W42,5W6G,5W6C,5T1K,5T1M,5T1L,5T33,5T3S,5T50,5T52,5T55,5T54,5T3X,5T3Z,5T5O,5T5P,5T5F,5T5J,5T5L,5T4Z,5T6P,5T70,5T7G,5T6X,5T6W,5T78,5T6Z,5T6Y,5SWQ,5SWS,5SWZ,5SZS,5TBD,5TEZ,5TH2,5TJ4,5TKK,5TKJ,5TLJ,5TLK,5TS1,5TRZ,5TUD,5U98,5TXS,5UD9,6E56,6E4X,6E62,6E5P,6E64,6E63,6E65,6DZR,6EA5,6EA7,6EDG,6EGS,6OAO,6OAN,6OCB,6OBZ,6OC3,6OEL,6OIL,6J1V,6J29,6ID4,6IEK,6IEQ,6IEC,6IEB,4FQY,4FQQ,4FQR,4FQV,4FQH,4FQI,4FQJ,4FQK,4FQL,4FQM,4FQC,4G6A,4G9D,4G8G,4G8I,4G9F,5FOJ,6BXE,6BXD,6BXA,6BXC,6CDP,6CDO,6CDI,6CDM,6CDE,6CFE,6CEZ,6CH8,6CH7,6CH9,6CHB,6CK8,6CJK,6CNV,6CNW,6D01,4WHY,4WHT,4WJ5,4WMY,4WMQ,4X0K,5F3J,5ETU,5EUK,5F88,5F89,6ALK,6B0W,6B0N,6B0S,6B14,4XMK,4XML,4P12,4P25,4P2N,4P26,4P1V,4ORG,4P3I,6OKQ,6OKP,6ONF,6ONE,6ONH,6OOG,6OOI,6ONV,6ORQ,6PBW,6PBV,6PBH,6PCI,6PEH,6PDX,6PLK,6ORN,6ORP,6ORO,6P65,6P62,6OUS,6P6F,6OVN,6OVO,6P91,6P95,6TID,6TIG,6TMH,6TMG,6TMJ,6TMI,6TML,6TMK,6U02,6TOU,6U3M,6U3O,6U3N,6T6R,6SVL,6SVK,6TDW,6TDV,6TDY,6TDX,6TDZ,6TE0,6TDU,6U51,6U50,6U53,6U52,6U55,6U54,6U59,6S8D,6S8J,6S8I,6SSA,6SS7,6SS9,6SS8,6UYE,6VBO,6VBQ,6VBP,6VFK,6VFL,6VLN,6VLR,6VN0,6W00,6VO1,6W05,6VOR,6VOS,6W16,6VR1,6VQO,6VRM,6VRN,6W41,6VR5,6VSR,6VTH,6VTC,6VTW,6HBY,6HCR,6HHC,6HIG,6I2G,1FZK,1FZJ,1FZO,1FZM,1GAF,2MHM,2MK1,2MPE,2MPA,2N1A,2N3B,2MU7,2NLG,2NLF,2NLE,2NLD,2NLC,2NLB,2NLH,2NLS,2NLQ,2NLP,2NUP,2NUT,2NW2,2NW3,2NX5,2NY4,2NY3,2NY2,2NY1,2NY0,2NXZ,2NXY,2NY7,2NY6,2NY5,2OBE,2NCT,2NCS,2KMB,2L1D,2LDX,2LFT,2LKL,2L40,2L39,2L5K,2KZJ,2KZI,2LM9,2LSB,2M64,2LUM,2LX4,2M8O,2M8M,2MAR,2J5L,2J6E,2JAB,2JMH,2JON,2JNZ,2JO7,2J88,2JSF,2JZ3,2KK9,6OY4,6P9N,6OZ9,6Q20,6Q23,6Q1Z,6PX6,6PY2,6PXG,6PXH,6PZ8,6PZY,6PZZ,6PZW,6PZH,6PZE,6PZD,6PZG,6PZF,6QB2,6Z3K,6Z3P,6Z3Q,6ZCZ,6ZDH,6ZDG,6ZER,6ZFO,6ZH9,6ZXN,7A23,7A24,6L31,6LM3,6M0J,6LZG,6MAR,6MCO,6MEG,6MEF,6MEI,6MEH,6MEK,6NCA,6NHQ,6NHP,6NHR,6NMR,6NN3,6NMT,6NMS,6NM6,6NNF,6NNJ,6NMV,6NMU,6O24,6O23,6O26,6O25,6O28,6O2B,6O2A,6O2C,6O29,6O3U,6O3K,6O3J,6O3L,6O42,6O41,6O3D,6O3G,6O4Z,6O4Y,6O51,6O53,6XCN,6XCM,6XCA,6XDG,6XEY,6XW4,6XWI,6XW6,6XW5,6XW7,6XXV,6YEW,6YEY,6MEJ,6MEE,6MED,6ME1,6MDT,6MFG,6MFJ,6MFF,6MFP,6MID,6MNF,6N35,6N2X,6N32,6MSY,6MU3,6N5E,6N5B,6N5D,6MUB,6N81,6N7U,6N7J,6MVL,6N8D,6FN1,6FN4,6G0V,6FRR,6FY2,6FY1,6FY3,6FYT,6FYS,6FYU,6FYW,6FZR,6FZQ,6JOX,6JOZ,6K0Y,6JP3,6K3M,6K69,6K64,6K65,6K68,6K67,6K6B,6K6A,6JY4,6JY3,6JYN,6JYO,6JYR,6JYS,1IUD,1IVZ,1JFQ,1JGU,1JGV,1JK8,1JNL,1JNH,1JNN,1JN6,1JOT,1JPG,1JPF,1K2D,1KC5,1KCV,1KCU,1KCS,1KCR,1KEM,1KEL,1KKC,1KN2,1KMB,1KNO,1KN4,2FO4,2FNB,2G57,2FSE,2G5B,2G60,2FX9,2FX8,2FX7,2FWO,2FYY,2FZ3,2GJJ,2GT9,2GTZ,2GTW,2H6P,2GUO,2GUM,1QOK,1QNX,1QOV,2F5B,2F5A,2FAT,2F19,2FJH,2FJG,2FJF,7DD2,7DCC,7DDN,7DDD,7DCX,7DD8,7DK6,7DK7,7DK4,7DK5,7DM2,7DM1,7C80,7C81,7C9W,7C9X,7C9U,7C9V,7C9Y,7C9Z,7C9S,7C9T,7BZ5,7CH4,7CH5,7CHF,7CHE,7CHH,7CHB,7CHC,7CMK,6QMQ,6QMP,6QMS,6R2S,6QRN,1AHM,1AHK,1AJ7,1BAF,1BRV,1C5B,1BTV,1C5C,1BV1,1BFV,1BII,1BLN,1C12,1BOG,1C1E,1MI5,1MJJ,1MJ8,1MJ7,1LO3,1LO2,1LO0,1M05,1LO4,1M26,1M3X,1LTI,1M71,1M7I,1LVE,1M7D,1LX5,1LXI,1MFA,1MFE,1MFC,1MFB,6RCO,6RCQ,6RCS,6RCV,6RCU,6S3D,6S2X,6KTR,6L62,6KVM,6KX9,6KYZ,6KZ0,6UTE,6UTA,6UVO,6V8Q,1MJU,1MPA,1N3K,1N3N,1N47,1N64,1N59,1MTC,1N5A,1N7M,6UC5,6UDA,6UDJ,6UDK,6UK4,6UJO,6UJQ,6UK2,6ULF,6ULE,6UM7,6UM6,6UM5,6UOE,1V84,1V83,1UZG,1UZ8,1UZ6,1V82,1V7N,1V7M,2CGZ,2CGY,2CII,2CJU,2D3S,2CYG,2DDQ,2DF7,2AXF,2AXI,2BCK,2BFV,2BK0,2BNU,2BNR,2BNQ,2C1P,2C1O,2BS6,2BS5,2BRR,2C3E,2BT9,2BST,2BSS,2BSR,2C7U,2BVQ,2BVP,2BVO,7K3Q,7K43,7K45,7K4N,7JVA,7JV6,7JV4,7JV2,7JW0,7JVC,7JXC,7JXD,7JX3,7JXE,1A0Q,1A22,1A3L,1A4K,1A4J,1A7L,1ADQ,1ACY,8FAB,1HHV,1HI6,1HKL,1HNG,1HOC,1I1R,1I3V,1I3U,1I3G,1I4F,1HTJ,1HUQ,1IBG,1IAK,1IAI,1IGJ,1IGI,1IIK,1III,1IL1,1IJS,1INQ,1INE,1IND,1I8K,1I8I,1I9R,1HZH,1S3K,1RVF,1S7T,1S7S,1S7R,1S7Q,1S7X,1S7W,1S7V,1S7U,1S9V,1S9Y,1S9X,1S9W,1SBS,1SEQ,1SS3,1T61,1T60,1T66,1T95,1SJV,1SM3,1Y0L,1Y18,1XWV,1YED,1YEC,1YEE,1YN7,1YN6,1YMM,1YNT,1YQV,1Z2Q,1Z3Q,1YS5,1YUH,1YY8,1YY9,1G1O,1FPT,1FRG,1FSK,1FV1,1G7Q,1FWV,1FWU,1GNE,1H2O,1H8S,1H8O,1H8N,1E6O,1E6J,1DVF,1DZL,1EAP,1ED3,1EHL,1EGX,1EO8,1DSF,1F45,1F42,1ES7,1F3D,1F3J,1ESL,1ETZ,1F90,1FAI,1FDL,1FE8,1FG2,1FIG,1FJ1,1FL6,1FL5,1FL3,1CE6,1CFS,1CFQ,1CFN,1CFV,1CFT,1CIC,1CL7,1CR9,1CU4,1D5I,1D5B,1D6V,1CZ8,1DDH,1DL7,1E28,1E27,1E4W,1E4X,1P4P,1OAZ,1OAY,1OAX,1OAU,1OAR,1OAQ,1OB1,1OCW,1OGV,1PC8,1PG7,1PJW,1PLG,1JUF,1KB9,1KBG,1KQR,1KRI,1L3Y,1KTJ,1L7I,1KZQ,1LB0,1LCX,1LLT,1MH5,1MIE,1MZI,1NCD,1NCA,1NCW,1ND0,1NGZ,1NGQ,1NGP,1NGY,1NGX,1NGW,1NJ0,1NIZ,1NLB,1NMA,1NUB,1OP9'

epidir = 'F:\BPR_Data\epitope_full_v3\\'
pdbdir = 'F:\BPR_Data\PDB\\'

def get_pdb(pdbl,filename):
    logging.info("Thread %s: starting.", filename)
    pdbl.retrieve_pdb_file(filename,pdir=pdbdir,file_format='pdb')
    logging.info("Thread %s: ending.", filename)

pdbl = Bio.PDB.PDBList()
PDBlist2=pdbstr.split(',')

threadlist = list()
for i in PDBlist2:
    threadlist.append(threading.Thread(target=get_pdb,args=(pdbl,i,)))

for thread in threadlist:
    thread.start()

'''
for file in os.listdir(pdbdir):
    if file[-3:] == '.gz' and not os.path.exists(pdbdir+file[:-3]+'.pdb'):
        f_in = gzip.open(pdbdir+file, 'r')
        f_out = open(pdbdir+file[:-3].replace('ent','pdb'), 'wb')
        f_out.write(f_in.read())
        f_in.close()
        f_out.close()

    if file[-4:] != '.pdb':
        os.remove(pdbdir+file)
 
if not os.path.exists('seqfile.txt'):
    with open(epidir+"epitope_full_v3.csv","r",encoding="utf-8") as iedbFile:
        iedbFile.readline()
        iedbFile.readline()
        csvreader = csv.reader(iedbFile, delimiter=',', quotechar='"')
   
        for row in csvreader:
            seq = row[2]

            if seq.find('+') != -1:
                seq = re.sub(re.escape(seq),re.escape(' + *$'), '')

            if len(seq)>=13 and len(seq)<25:
                seqSet.add(seq.strip())

        with open('seqfile.txt','w') as seqFile:
            for seq in seqSet:
                seqFile.write(seq+'\n')
else:
    with open('seqfile.txt') as seqFile:
        for seq in seqFile.readlines():
            seqSet.add(seq.replace('\n',''))


pdbSet = set()
for file in os.listdir(pdbdir):
    p = Bio.PDB.PDBParser()
    structure = p.get_structure('X', pdbdir+file)
    
    cnt = 0
    ppb = Bio.PDB.PPBuilder()
    for pp in ppb.build_peptides(structure):
        cnt += 1
        if pp.get_sequence() in seqSet and pp.get_sequence() not in pdbSet:
            print(pp.get_sequence())
            pdbSet.add(pp.get_sequence())
            '''